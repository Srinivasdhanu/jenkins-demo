- hosts: web
  become: yes
  user: test
  gather_facts: False
  tasks:
  - name: Install python pip
    yum:
      name: python3-pip
      state: present
  - name: Install docker
    yum:
      name: docker
      state: present
  - name: start docker
    service:
      name: docker
      state: started
      enabled: yes
  - name: install certain python modules for docker
    pip:
      name: "{{ item.name }}"
      version: "{{ item.version }}"
      state: present
    with_items:
    - { name: docker, version: 2.0.0 }
    - { name: docker-py, version: 1.10.6 }
 
      
  - name: Start the container
      docker_container:
        name: demo
        image: "srinivaskollipaka/demo:{{DOCKER_TAG}}"
        state: started
        published_ports:
          - 0.0.0.0:8080:8080
